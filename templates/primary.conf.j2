# Primary server configuration for slave PowerDNS servers
# This file specifies which master server to replicate from with TSIG authentication

{% set env = 'staging' if DEPLOY_ENV == 'staging' else 'production' %}
{% set zones = powerdns[env].zones %}
{% set master_ip = powerdns[env].master_ip %}

# Configure zones from master server with TSIG authentication
{% for zone in zones %}
# Zone: {{ zone }}
[{{ zone }}]
type=slave
master={{ master_ip }}:53
tsig-algo=hmac-sha256
tsig-secret={{ powerdns[env].tsig_zone_transfer_key }}
tsig-name=zone-transfer

{% endfor %}