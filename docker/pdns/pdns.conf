# PowerDNS Configuration for Docker Testing - Bind Backend
# This configuration tests the NEW bind backend implementation

# Primary backend - Bind backend for all zones  
launch=bind

# Bind backend configuration
bind-config=/etc/powerdns/named.conf
bind-check-interval=60

# Enable Lua records for geo-routing and app routing
enable-lua-records=yes
lua-health-checks-interval=2

# Lua scripting enabled - scripts loaded via zone files
# lua-records-exec-file is not available in PowerDNS 4.9

# GeoIP configuration (not available in PowerDNS 4.9)
# geoip-database-files=/usr/share/GeoIP/GeoLite2-City.mmdb
# geoip-database-mode=mmdb

# EDNS Client Subnet for better geo-location accuracy
edns-subnet-processing=yes

# Performance and caching settings
cache-ttl=60
negquery-cache-ttl=60
query-cache-ttl=20
max-cache-entries=100000

# Logging configuration
loglevel=6
log-dns-queries=yes
log-dns-details=yes

# Security settings
webserver=no
api=no

# DNSSEC settings - prevent DNSSEC key responses to avoid REFUSED errors
direct-dnskey=no

# Network settings
local-address=0.0.0.0
local-port=53
socket-dir=/var/run/pdns

# Thread settings
distributor-threads=1
receiver-threads=1

# Query settings
max-tcp-connections=10
max-queue-length=1000

# Zone transfer settings
allow-axfr-ips=127.0.0.1
primary=no
secondary=no